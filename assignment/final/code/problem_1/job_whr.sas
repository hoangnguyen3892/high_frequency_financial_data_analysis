/*Connect to server*/


%let wrds=wrds.wharton.upenn.edu 4016;
options comamid=TCP remote=WRDS;
signon username=hnguyen1 password='{SAS002}5B3C701F054358A017576B7E40CAC6AC28E24133214780B55B10E1C943B596FE';

/*Submit sas statements to WRDS*/
rsubmit;
	libname nbbo '/wrds/nyse/sasdata/taqms/nbbo';
	libname cq '/wrds/nyse/sasdata/taqms/cq';
	libname ct '/wrds/nyse/sasdata/taqms/ct';
	libname whr '/home/unist/hnguyen1/final/whr';
	option msglevel=i mprint source;

proc printto log='log_whr.txt';
run;

/*Function*/
%macro loop(vlist);

/**********************VARIABLE*********************/
%let count=%sysfunc(countw(&vlist));

%do i=1 %to &count;

%let date=%scan(&vlist, &i);
%let ticker_name = WHR;

/***********************Get daily data***********************/

/**********************DAILY NBBO*********************/
data DailyNBBO;
set nbbo.nbbom_&date;
where sym_root in ("&ticker_name")
and (('9:00:00.000000't) <= time_m <= ('16:00:00.000000't)); 
format date date9.;
format time_m part_time trf_time time20.6;
run;


/**********************DAILY QUOTE*********************/
data DailyQuote;
set cq.cqm_&date;
where sym_root in ("&ticker_name")
and (('9:00:00.000000't) <= time_m <= ('16:00:00.000000't)); 
format date date9.;
format time_m part_time trf_time time20.6;
run;

/**********************DAILY TRADE*********************/
data DailyTrade;
set ct.ctm_&date;
where sym_root in ("&ticker_name")
and (('9:30:00.000000't) <= time_m <= ('16:00:00.000000't));
type='T'; 
format date date9.;
format time_m part_time trf_time time20.6;
run;


/***********************Clean daily data***********************/

/**********************NBBO*********************/
data nbbo2;
set DailyNBBO; *This is DailyNBBO data;

/*Select data in working hours*/
where (('9:00:00.000000't) <= time_m <= ('16:00:00.000000't)); 

/*Quote condition*/
if qu_cond not in ('A', 'B', 'H', 'O', 'R', 'W') then delete;

if qu_cancel = 'B' then delete;

spread = best_ask - best_bid;
midpoint = (best_ask + best_bid)/2;


if best_ask le 0 then do;
	best_ask = .;
	best_asksiz = .;
end;
if best_ask=. then best_asksiz=.;
/*-----------------------------*/
if best_asksiz le 0 then do;
	best_ask = .;
	best_asksiz = .;
end;
if best_asksiz=. then best_ask=.;
/*-----------------------------*/
if best_bid le 0 then do;
	best_bid = .;
	best_bidsiz = .;
end;
if best_bid=. then best_bidsiz=.;
/*-----------------------------*/
if best_bidsiz le 0 then do;
	best_bid = .;
	best_bidsiz = .;
end;
if best_bidsiz=. then best_bid=.;

/*Create new shares*/
best_bidsizeshares = best_bidsiz *100;
best_asksizeshares = best_asksiz *100;

format date date9.;
format time_m time20.6;
run;

proc sort
	data=nbbo2 (drop = best_bidsiz best_asksiz);
	by sym_root sym_suffix date time_m;
run;

data nbbo2;
set nbbo2;
by sym_root sym_suffix date time_m;
lmid = lag(midpoint);
if first.sym_root or first.date or first.sym_suffix then lmid =.;
lm25=lmid-2.5;
lp25=lmid+2.5;
run;

data nbbo2;
set nbbo2;
if spread gt 5 and best_bid lt lm25 then do;
	best_bid = .;
	best_bidsizeshares = .;
end;

if spread gt 5 and best_ask lt lp25 then do;
	best_ask = .;
	best_asksizeshares = .;
end;

keep 	date time_m ex sym_root sym_suffix
		best_bidex best_bid best_bidsizeshares 
		best_askex best_ask best_asksizeshares
		qu_seqnum spread;
run;

data nbbo2;
set nbbo2;
if sym_root ne lag(sym_root)
or sym_suffix ne lag(sym_suffix)
or date ne lag(date)
or best_ask ne lag(best_ask)
or best_bid ne lag(best_bid)
or best_asksizeshares ne lag(best_asksizeshares)
or best_bidsizeshares ne lag(best_bidsizeshares);
run;

/**********************QUOTE*********************/
data quoteab;
set DailyQuote;

/*Select data in working hours*/
where (('9:00:00.000000't) <= time_m <= ('16:00:00.000000't)); 

Spread = Ask - Bid;

/*Quote condition*/
if qu_cond not in ('A', 'B', 'H', 'O', 'R', 'W') then delete;

if Bid>Ask then delete;

if Spread>5 then delete;

if ask le 0 or ask=. then delete;
if asksiz le 0 or asksiz=. then delete;
if bid le 0 or bid=. then delete;
if bidsiz le 0 or bidsiz=. then delete;

drop sym_suffix bidex askex qu_cancel qu_source rpi ssr 
luld_bbo_cqs luld_bbo_utp finra_adf_mpid sip_message_id 
part_time rrn trf_time natl_bbo_luld;
run;


/**********************TRADE*********************/
data trade2;
set DailyTrade;
where (('9:30:00.000000't) <= time_m <= ('16:00:00.000000't)) and
Tr_corr eq '00' and price gt 0; 
type='T';
drop tr_corr tr_source tr_rf part_time
rnn trf_time sym_suffix tr_scond tr_stopind;
run;

/***********************Create merged files***********************/

/**********************OFFICIAL NBBO*********************/
data quoteab2 (rename=(ask=best_ask bid=best_bid));
set quoteab;
where natbbo_ind='1' or nasdbbo_ind='4';
keep date time_m sym_root qu_seqnum bid best_bidsizeshares ask best_asksizeshares;

best_bidsizeshares = bidsiz*100;
best_asksizeshares = asksiz*100;
run;


proc sort data=nbbo2;
by sym_root date qu_seqnum;
run;

proc sort data=quoteab2;
by sym_root date qu_seqnum;
run;

data OfficialCompleteNBBO (drop=best_askex best_bidex);
set nbbo2 quoteab2;
by sym_root date qu_seqnum;
run;

proc sort data=OfficialCompleteNBBO;
by sym_root date time_m descending qu_seqnum;
run;

proc sort data=OfficialCompleteNBBO nodupkey;
by sym_root date time_m;
run;


/**********************OFFICIAL NBBO*********************/
data OfficialCompleteNBBO;
set OfficialCompleteNBBO; type='Q';
time_m=time_m+.000001;
drop qu_seqnum;
run;

proc sort data=trade2;
by sym_root date time_m tr_seqnum;
run;

data TradesandCorrespondingNBBO;
set OfficialCompleteNBBO trade2;
by sym_root date time_m type;
run;

data TradesandCorrespondingNBBO (drop=best_ask best_bid best_asksizesshares best_bidsizeshares);
set TradesandCorrespondingNBBO;
by sym_root date;
retain Qtime nbo nbb nboqty nbbqty;
if first.sym_root then do;
	qtime=.;
	nbo=.;
	nbb=.;
	nboqty=.;
	nbbqty=.;
	size=.;
end;

if type='Q' then qtime=time_m;
else qtime=qtime;

if type='Q' then nbo=best_ask;
else nbo=nbo;

if type='Q' then nbb=best_bid;
else nbb=nbb;

if type='Q' then nboqty=best_asksizeshares;
else nboqty=nboqty;

if type='Q' then nbbqty=best_bidsizeshares;
else nbbqty=nbbqty;
format qtime time20.6;
run;


/**********************BUY SELL INDICATORS*********************/
data BuySellIndicators;
set TradesandCorrespondingNBBO;
where type='T';

midpoint=(NBO+NBB)/2;
if NBO=NBB then lock=1;else lock=0;
if NBO<NBB then cross=1;else cross=0;
run;

data BuySellIndicators;
set BuySellIndicators;
by sym_root date;
retain direction2;
direction=dif(price);
if first.sym_root or first.date then direction=.;
if direction ne 0 then direction2=direction;
else direction2=direction2;
drop direction;
run;

data BuySellIndicators;
set BuySellIndicators;
if direction2>0 then BuySellLR=1;
if direction2<0 then BuySellLR=-1;
if direction2=. then BuySellLR=.;

if direction2>0 then BuySellEMO=1;
if direction2<0 then BuySellEMO=-1;
if direction2=. then BuySellEMO=.;

if direction2>0 then BuySellCLNV=1;
if direction2<0 then BuySellCLNV=-1;
if direction2=. then BuySellCLNV=.;
run;

data BuySellIndicators;
set BuySellIndicators;
if lock=0 and cross=0 and price gt midpoint then BuySellLR=1;
if lock=0 and cross=0 and price lt midpoint then BuySellLR=-1;

if lock=0 and cross=0 and price=NBO then BuySellEMO=1;
if lock=0 and cross=0 and price=NBB then BuySellEMO=-1;

ofr30=NBO-.3*(NBO-NBB);
bid30=NBB+.3*(NBO-NBB);

if lock=0 and cross=0 and price le NBO and price ge ofr30 then BuySellCLNV=1;
if lock=0 and cross=0 and price le bid30 and price ge NBB then BuySellCLNV=-1;
run;

/*
*Check save data into WRDS folder;
data whr.BuySellIndicators_&date;
set BuySellIndicators;
run;
*/

/***********************Compute variables***********************/

data mediate1;
set BuySellIndicators;
DV = size*price; *problem b;
y = BuySellLR*size - lag(BuySellLR)*lag(size); *problem b;
z = BuySellLR*size*price - lag(BuySellLR)*lag(size)*lag(price); *problem b;
r = log(price) - log(lag(price)); *problem c;
delta_pt = price-lag(price); *problem d;
delta_pt1 = lag(price)-lag2(price); *problem d;
A = abs(r)/(price*size); *problem e;
wes_Dollar = (abs(price-midpoint))*2; *problem f;
wes_Dollar_SW = wes_Dollar*size; *problem f;
wres_Dollar_SW = wes_Dollar_SW/midpoint; *problem f;
res = es/midpoint; *problem f;
lag_y = lag(y); *problem g;
lag_z = lag(z); *problem g;
run;

/*problem a*/
data mediate2 (keep=date sym_root p_d m_d);
set BuySellIndicators;
by sym_root;
if last.sym_root;
rename price = p_d; *problem a;
rename midpoint = m_d; *problem a;
run;

/*problem b, c, e*/
proc means noprint data=mediate1 mean std;
var size DV y z A;
output out= mediate3
mean(size) = V_d
mean(DV) = DV_d
mean(y) = y_d
mean(z)= z_d
std(r) = sigma_d
mean(A) = A_d
;
run; 

/*problem d*/
proc corr noprint data=mediate1 outp=mediate4 cov; *or outs;
var delta_pt delta_pt1;
run;

data mediate4(keep=s_d);
set mediate4;
where _NAME_ in ('delta_pt1') and _TYPE_ in ('COV');
s_d = sqrt(-delta_pt)/2;
run;

/*problem f*/
proc sql;
create table effectivespread
as select
sum(size) as sumsize,
sum(wes_Dollar_SW) as waes_Dollar_SW,
sum(wres_Dollar_SW) as wares_Dollar_SW
from mediate1;
quit;

data mediate5 (keep= es_d res_d);
set effectivespread;
es_d = waes_Dollar_SW/sumsize;
res_d = wares_Dollar_SW/sumsize;
run;

/*problem g*/
proc reg noprint data=mediate1 outest=mediate6;
model r = y lag_y;
run;
data mediate6 (keep=lambda1_d psi1_d);
set mediate6;
rename y = lambda1_d;
rename lag_y = psi1_d;
run;

proc reg noprint data=mediate1 outest=mediate7;
model r = z lag_z;
run;
data mediate7 (keep=lambda2_d psi2_d);
set mediate7;
rename z = lambda2_d;
rename lag_z = psi2_d;
run;

/*problem h*/
proc arima data=mediate1;
identify var=BuySellLR noprint;
estimate p=1 q=1 method=ml outest=mediate8 noprint; 
run;quit;

data mediate8 (keep=rho_d gamma_d);
set mediate8;
where _TYPE_ in ('EST');
rename AR1_1 = rho_d;
rename MA1_1 = gamma_d;
run;


data estim (keep=date sym_root p_d m_d V_d DV_d y_d z_d sigma_d A_d s_d 
			es_d res_d lambda1_d psi1_d lambda2_d psi2_d rho_d gamma_d);
set mediate2;
set mediate3;
set mediate4;
set mediate5;
set mediate6;
set mediate7;
set mediate8;
run;

*Save data into WRDS folder;
data whr.estim_&date;
set estim;
run;

%end;
%mend;

/*Begin looping*/

%let date_list=20030910 20030911 20030912 20030915 20030916 20030917 20030918 
20030919 20030922 20030923 20030924 20030925 20030926 20030929 
20030930 20031001 20031002 20031003 20031006 20031007 20031008 
20031009 20031010 20031013 20031014 20031015 20031016 20031017 
20031020 20031021 20031022 20031023 20031024 20031027 20031028 
20031029 20031030 20031031 20031103 20031104 20031105 20031106 
20031107 20031110 20031111 20031112 20031113 20031114 20031117 
20031118 20031119 20031120 20031121 20031124 20031125 20031126
20031128 20031201 20031202 20031203 20031204 20031205 20031208 
20031209 20031210 20031211 20031212 20031215 20031216 20031217
20031218 20031219 20031222 20031223 20031224 20031226 20031229
20031230 20031231

20040102 20040105 20040106 20040107 20040108 20040109 20040112 
20040113 20040114 20040115 20040116 20040120 20040121 20040122 
20040123 20040126 20040127 20040128 20040129 20040130 20040202 
20040203 20040204 20040205 20040206 20040209 20040210 20040211 
20040212 20040213 20040217 20040218 20040219 20040220 20040223 
20040224 20040225 20040226 20040227 20040301 20040302 20040303 
20040304 20040305 20040308 20040309 20040310 20040311 20040312 
20040315 20040316 20040317 20040318 20040319 20040322 20040323 
20040324 20040325 20040326 20040329 20040330 20040331 20040401 
20040402 20040405 20040406 20040407 20040408 20040412 20040413 
20040414 20040415 20040416 20040419 20040420 20040421 20040422 
20040423 20040426 20040427 20040428 20040429 20040430 20040503 
20040504 20040505 20040506 20040507 20040510 20040511 20040512 
20040513 20040514 20040517 20040518 20040519 20040520 20040521 
20040524 20040525 20040526 20040527 20040528 20040601 20040602 
20040603 20040604 20040607 20040608 20040609 20040610 20040614 
20040615 20040616 20040617 20040618 20040621 20040622 20040623 
20040624 20040625 20040628 20040629 20040630 20040701 20040702 
20040706 20040707 20040708 20040709 20040712 20040713 20040714 
20040715 20040716 20040719 20040720 20040721 20040722 20040723 
20040726 20040727 20040728 20040729 20040730 20040802 20040803 
20040804 20040805 20040806 20040809 20040810 20040811 20040812 
20040813 20040816 20040817 20040818 20040819 20040820 20040823 
20040824 20040825 20040826 20040827 20040830 20040831 20040901 
20040902 20040903 20040907 20040908 20040909 20040910 20040913 
20040914 20040915 20040916 20040917 20040920 20040921 20040922 
20040923 20040924 20040927 20040928 20040929 20040930 20041001 
20041004 20041005 20041006 20041007 20041008 20041011 20041012 
20041013 20041014 20041015 20041018 20041019 20041020 20041021 
20041022 20041025 20041026 20041027 20041028 20041029 20041101 
20041102 20041103 20041104 20041105 20041108 20041109 20041110 
20041111 20041112 20041115 20041116 20041117 20041118 20041119 
20041122 20041123 20041124 20041126 20041129 20041130 20041201 
20041202 20041203 20041206 20041207 20041208 20041209 20041210 
20041213 20041214 20041215 20041216 20041217 20041220 20041221 
20041222 20041223 20041227 20041228 20041229 20041230 20041231


20050103 20050104 20050105 20050106 20050107 20050110 20050111 
20050112 20050113 20050114 20050118 20050119 20050120 20050121 
20050124 20050125 20050126 20050127 20050128 20050131 20050201 
20050202 20050203 20050204 20050207 20050208 20050209 20050210 
20050211 20050214 20050215 20050216 20050217 20050218 20050222 
20050223 20050224 20050225 20050228 20050301 20050302 20050303 
20050304 20050307 20050308 20050309 20050310 20050311 20050314 
20050315 20050316 20050317 20050318 20050321 20050322 20050323 
20050324 20050328 20050329 20050330 20050331 20050401 20050404 
20050405 20050406 20050407 20050408 20050411 20050412 20050413 
20050414 20050415 20050418 20050419 20050420 20050421 20050422 
20050425 20050426 20050427 20050428 20050429 20050502 20050503 
20050504 20050505 20050506 20050509 20050510 20050511 20050512 
20050513 20050516 20050517 20050518 20050519 20050520 20050523 
20050524 20050525 20050526 20050527 20050531 20050601 20050602 
20050603 20050606 20050607 20050608 20050609 20050610 20050613 
20050614 20050615 20050616 20050617 20050620 20050621 20050622 
20050623 20050624 20050627 20050628 20050629 20050630 20050701 
20050705 20050706 20050707 20050708 20050711 20050712 20050713 
20050714 20050715 20050718 20050719 20050720 20050721 20050722 
20050725 20050726 20050727 20050728 20050729 20050801 20050802 
20050803 20050804 20050805 20050808 20050809 20050810 20050811 
20050812 20050815 20050816 20050817 20050818 20050819 20050822 
20050823 20050824 20050825 20050826 20050829 20050830 20050831 
20050901 20050902 20050906 20050907 20050908 20050909 20050912 
20050913 20050914 20050915 20050916 20050919 20050920 20050921 
20050922 20050923 20050926 20050927 20050928 20050929 20050930 
20051003 20051004 20051005 20051006 20051007 20051010 20051011 
20051012 20051013 20051014 20051017 20051018 20051019 20051020 
20051021 20051024 20051025 20051026 20051027 20051028 20051031 
20051101 20051102 20051103 20051104 20051107 20051108 20051109 
20051110 20051111 20051114 20051115 20051116 20051117 20051118 
20051121 20051122 20051123 20051125 20051128 20051129 20051130 
20051201 20051202 20051205 20051206 20051207 20051208 20051209 
20051212 20051213 20051214 20051215 20051216 20051219 20051220 
20051221 20051222 20051223 20051227 20051228 20051229 20051230

20060103 20060104 20060105 20060106 20060109 20060110 20060111 
20060112 20060113 20060117 20060118 20060119 20060120 20060123 
20060124 20060125 20060126 20060127 20060130 20060131 20060201 
20060202 20060203 20060206 20060207 20060208 20060209 20060210 
20060213 20060214 20060215 20060216 20060217 20060221 20060222 
20060223 20060224 20060227 20060228 20060301 20060302 20060303 
20060306 20060307 20060308 20060309 20060310 20060313 20060314 
20060315 20060316 20060317 20060320 20060321 20060322 20060323 
20060324 20060327 20060328 20060329 20060330 20060331 20060403 
20060404 20060405 20060406 20060407 20060410 20060411 20060412 
20060413 20060417 20060418 20060419 20060420 20060421 20060424 
20060425 20060426 20060427 20060428 20060501 20060502 20060503 
20060504 20060505 20060508 20060509 20060510 20060511 20060512 
20060515 20060516 20060517 20060518 20060519 20060522 20060523 
20060524 20060525 20060526 20060530 20060531 20060601 20060602 
20060605 20060606 20060607 20060608 20060609 20060612 20060613
20060614 20060615 20060616 20060619 20060620 20060621 20060622
20060623 20060626 20060627 20060628 20060629 20060630 20060703
20060705 20060706 20060707 20060710 20060711 20060712 20060713
20060714 20060717 20060718 20060719 20060720 20060721 20060724
20060725 20060726 20060727 20060728 20060731 20060801 20060802
20060803 20060804 20060807 20060808 20060809 20060810 20060811
20060814 20060815 20060816 20060817 20060818 20060821 20060822
20060823 20060824 20060825 20060828 20060829 20060830 20060831
20060901 20060905 20060906 20060907 20060908 20060911 20060912 
20060913 20060914 20060915 20060918 20060919 20060920 20060921 
20060922 20060925 20060926 20060927 20060928 20060929 20061002 
20061003 20061004 20061005 20061006 20061009 20061010 20061011 
20061012 20061013 20061016 20061017 20061018 20061019 20061020 
20061023 20061024 20061025 20061026 20061027 20061030 20061031 
20061101 20061102 20061103 20061106 20061107 20061108 20061109 
20061110 20061113 20061114 20061115 20061116 20061117 20061120 
20061121 20061122 20061124 20061127 20061128 20061129 20061130 
20061201 20061204 20061205 20061206 20061207 20061208 20061211 
20061212 20061213 20061214 20061215 20061218 20061219 20061220 
20061221 20061222 20061226 20061227 20061228 20061229

20070103 20070104 20070105 20070108 20070109 20070110 20070111 
20070112 20070116 20070117 20070118 20070119 20070122 20070123 
20070124 20070125 20070126 20070129 20070130 20070131 20070201 
20070202 20070205 20070206 20070207 20070208 20070209 20070212 
20070213 20070214 20070215 20070216 20070220 20070221 20070222 
20070223 20070226 20070227 20070228 20070301 20070302 20070305 
20070306 20070307 20070308 20070309 20070312 20070313 20070314 
20070315 20070316 20070319 20070320 20070321 20070322 20070323 
20070326 20070327 20070328 20070329 20070330 20070402 20070403 
20070404 20070405 20070409 20070410 20070411 20070412 20070413 
20070416 20070417 20070418 20070419 20070420 20070423 20070424 
20070425 20070426 20070427 20070430 20070501 20070502 20070503 
20070504 20070507 20070508 20070509 20070510 20070511 20070514 
20070515 20070516 20070517 20070518 20070521 20070522 20070523 
20070524 20070525 20070529 20070530 20070531 20070601 20070604 
20070605 20070606 20070607 20070608 20070611 20070612 20070613 
20070614 20070615 20070618 20070619 20070620 20070621 20070622 
20070625 20070626 20070627 20070628 20070629 20070702 20070703 
20070705 20070706 20070709 20070710 20070711 20070712 20070713 
20070716 20070717 20070718 20070719 20070720 20070723 20070724 
20070725 20070726 20070727 20070730 20070731 20070801 20070802 
20070803 20070806 20070807 20070808 20070809 20070810 20070813 
20070814 20070815 20070816 20070817 20070820 20070821 20070822 
20070823 20070824 20070827 20070828 20070829 20070830 20070831 
20070904 20070905 20070906 20070907 20070910 20070911 20070912 
20070913 20070914 20070917 20070918 20070919 20070920 20070921 
20070924 20070925 20070926 20070927 20070928 20071001 20071002 
20071003 20071004 20071005 20071008 20071009 20071010 20071011 
20071012 20071015 20071016 20071017 20071018 20071019 20071022 
20071023 20071024 20071025 20071026 20071029 20071030 20071031 
20071101 20071102 20071105 20071106 20071107 20071108 20071109 
20071112 20071113 20071114 20071115 20071116 20071119 20071120 
20071121 20071123 20071126 20071127 20071128 20071129 20071130 
20071203 20071204 20071205 20071206 20071207 20071210 20071211 
20071212 20071213 20071214 20071217 20071218 20071219 20071220 
20071221 20071224 20071226 20071227 20071228 20071231

20080102 20080103 20080104 20080107 20080108 20080109 20080110 
20080111 20080114 20080115 20080116 20080117 20080118 20080122 
20080123 20080124 20080125 20080128 20080129 20080130 20080131 
20080201 20080204 20080205 20080206 20080207 20080208 20080211 
20080212 20080213 20080214 20080215 20080219 20080220 20080221
20080222 20080225 20080226 20080227 20080228 20080229 20080303
20080304 20080305 20080306 20080307 20080310 20080311 20080312
20080313 20080314 20080317 20080318 20080319 20080320 20080324
20080325 20080326 20080327 20080328 20080331 20080401 20080402
20080403 20080404 20080407 20080408 20080409 20080410 20080411 
20080414 20080415 20080416 20080417 20080418 20080421 20080422 
20080423 20080424 20080425 20080428 20080429 20080430 20080501 
20080502 20080505 20080506 20080507 20080508 20080509 20080512
20080513 20080514 20080515 20080516 20080519 20080520 20080521
20080522 20080523 20080527 20080528 20080529 20080530 20080602
20080603 20080604 20080605 20080606 20080609 20080610 20080611
20080612 20080613 20080616 20080617 20080618 20080619 20080620
20080623 20080624 20080625 20080626 20080627 20080630 20080701
20080702 20080703 20080707 20080708 20080709 20080710 20080711
20080714 20080715 20080716 20080717 20080718 20080721 20080722
20080723 20080724 20080725 20080728 20080729 20080730 20080731
20080801 20080804 20080805 20080806 20080807 20080808 20080811 
20080812 20080813 20080814 20080815 20080818 20080819 20080820 
20080821 20080822 20080825 20080826 20080827 20080828 20080829
20080902 20080903 20080904 20080905 20080908 20080909 20080910
20080911 20080912 20080915 20080916 20080917 20080918 20080919
20080922 20080923 20080924 20080925 20080926 20080929 20080930
20081001 20081002 20081003 20081006 20081007 20081008 20081009
20081010 20081013 20081014 20081015 20081016 20081017 20081020
20081021 20081022 20081023 20081024 20081027 20081028 20081029
20081030 20081031 20081103 20081104 20081105 20081106 20081107
20081110 20081111 20081112 20081113 20081114 20081117 20081118
20081119 20081120 20081121 20081124 20081125 20081126 20081128
20081201 20081202 20081203 20081204 20081205 20081208 20081209 
20081210 20081211 20081212 20081215 20081216 20081217 20081218 
20081219 20081222 20081223 20081224 20081226 20081229 20081230 
20081231

20090102 20090105 20090106 20090107 20090108 20090109 20090112 
20090113 20090114 20090115 20090116 20090120 20090121 20090122 
20090123 20090126 20090127 20090128 20090129 20090130 20090202 
20090203 20090204 20090205 20090206 20090209 20090210 20090211 
20090212 20090213 20090217 20090218 20090219 20090220 20090223 
20090224 20090225 20090226 20090227 20090302 20090303 20090304 
20090305 20090306 20090309 20090310 20090311 20090312 20090313 
20090316 20090317 20090318 20090319 20090320 20090323 20090324 
20090325 20090326 20090327 20090330 20090331 20090401 20090402 
20090403 20090406 20090407 20090408 20090409 20090413 20090414 
20090415 20090416 20090417 20090420 20090421 20090422 20090423 
20090424 20090427 20090428 20090429 20090430 20090501 20090504 
20090505 20090506 20090507 20090508 20090511 20090512 20090513 
20090514 20090515 20090518 20090519 20090520 20090521 20090522 
20090526 20090527 20090528 20090529 20090601 20090602 20090603
20090604 20090605 20090608 20090609 20090610 20090611 20090612
20090615 20090616 20090617 20090618 20090619 20090622 20090623
20090624 20090625 20090626 20090629 20090630 20090701 20090702
20090706 20090707 20090708 20090709 20090710 20090713 20090714
20090715 20090716 20090717 20090720 20090721 20090722 20090723
20090724 20090727 20090728 20090729 20090730 20090731 20090803
20090804 20090805 20090806 20090807 20090810 20090811 20090812
20090813 20090814 20090817 20090818 20090819 20090820 20090821
20090824 20090825 20090826 20090827 20090828 20090831 20090901
20090902 20090903 20090904 20090908 20090909;
%loop(&date_list);

/*Get full estimation for the whole period*/
data whr.estim_full;
set whr.estim_:;
run;

proc printto;
run;

endrsubmit;


